---
# Source: core/templates/controller-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: neuvector-controller-secret
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
type: Opaque
data:
  ssl-cert.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBeStjVXVvV3hKNVV2MHVYaGpVckZWM1NXaHRYdDUzZEZodk9xbytpVGhxRWpWc0NSCkxpdDRYeXFUV1B5R0VYSlh4M1IrZTNzWjZMVEQ3YVZrMVJtTE9wbnJKSjBJRUJTd1RPbzlpMnROZkdBR0xoRVUKMGRVUVp2eXo1R2dFMDRlMkhYdzYzYk9WMjVWQXFjclgvcWZOOXpGek0yVXRJeDFWYi9XVVlQaTZNbnp5bE5EaApyU0pyK2ZxeGdpWVQvRGZoYnBMRSs3YkNNbkJIK0YvNVFVbjIzOEdWUWhhUzR0TzlhSE02Vmo4VXVsS3pQZmdTCkNqWjhXOWFqcElRbTlOZ3dUU0lnQzJjY09BWmEwUGk4aFo5ZURiTW9DejlwYkJzRytjMitwdmJ3N1ZlcXh2Q0sKNlBVTG82T29rWlNTYS9ubU9Ma0x4d09ySExSWnNXQnBJZzI4b1FJREFRQUJBb0lCQUE3M0ZOUmp2NDdTS2tKbQpVTm1YNVVmMzdKeFUwek1yMDlTRnliNWg4WUh1RGJQdVNqbURRMEJvMVl1d2JQNld6ODU1eEZhM3dEME9GMXMzCnltREJrVEJwMzVJK1hEc2g2WmFia296TEFWTGhrVktNT21UMEtGSUd0Z1ZMaFI4cFZMcHhSYmpEMTNuWVNIaXQKeEpDU0xGRzZOV1JPUnJQUEVWZzRRLzJpQTdoMHhZeWFZNmErUW9yTlFCV2NwY1hDS0Q2ZFJCUi9oRWhHZG1BbQp0NGZGQkpqSTZqbzVFbGRWNXhObFdCOFdBTFBHMWF2bFdQWjJwTjRvc1FyT25XNUtxSzI5dTNDNE5IWUJobHk0CnB2S3VyN2oyQkgyaEt4TEFpVjMzZGF4SzAvWmtCS3VTVlAyY3hWVUpkOGdmWkFveDhOZjd1N05uNmhUWXBndEsKVmtpdVhlRUNnWUVBMHcvQ0liZEdXblBwWFZNTG01di9RT1dpQUJETUJoTG91ZmdZOEtYYnF0UmtEYUFQZ2l2SgpoQzNyUUJUY2k1SE04NHM1MmdodG5BKy96VER6UEZ4KzNoaEg0RVkwYUxCZjFkV3FTZktqUEc2aDFSRzVHaDFGCjl4ZUgyWlhaU1pETGVPQ1JkNkFKQUdZbEpEQ1g5ODViR1ZNSFlGaWRDNFdCV3FrSEdpVWNzajBDZ1lFQTkxRWQKbzNxMUpjeFZGa3NxZUQ5d25mQnVWbFY5WDlpME9oYi9vRVBuYVc4R0ZhMGltc0NiWkh1TDhSUUlZMkhRZ0tUWgoyVWZ6Nmwzamt1SzJlcEViR3d2MHNPV3V3Tk1EbzUvc04yMGNKbExkOEw2dHczR04yQlI0bE8xUzNOYWtGcXY4CmVqaFVUMFRMMitYNi82ZHFEZ3VxQmI0S3llcExOK0NmNTNncmpqVUNnWUJYVUdXWFhTS1Z1TzRKMVprdnZ0RlMKSDYxdEtZVzkzWVM1cXBGbXZMYXJiVUlYQU9ocGlZUE1VdExIcDltMVE1UHVET0xaK0RLZ0pVUEx0enhvOURybgoxbE9sekdWU0NlVWJxVkRSVnJlQkFLT2lhYnFSdXhwK3BoVmxSa0NsMW1qV2tOQ2RGRytrNHB6cTQ4OTZqTHZUCk5pNFBCWm15Y29DWTZPUXZSTHNpWVFLQmdRRFpNZmlZZ0lRajNNNEExU1JJRkZhL3JjNElyZTE4UmlFSlB2ZGgKOVNCKzNJejRibU9NaW9ndGQ3N1BpbXRQZERDYk9hdEVBY2U1VkprdWYwSUlZL1R0RE5Qb290MlU0L3czTDVSUQpuTmJ5NVNXYWJxckZrSzBrVGQ0VDFGUklNNHhKaU9Nakp1TUw5bndkODF3Nk52bVJ1amFuOGwwaE5FeTRsdUYzCmMzYTAzUUtCZ0h2RUc5TnI4VEo0Z3NPbys4NVphUnVTRmR3anJiODAwTVhGUjlJZmlwbzNoTnBuUWVUSHhEbnMKK2xoaGo2VVlJVnlULzdGanJpNmp4a2JsMThYWTlqaDJoTmQ3YUE2b2tMRTdHY3VXR0tZNFN0L0xmeklqcTdybQp0TlE1anNHenEvTHZCcjNEcjF4MW41VUhSWXAzMHArMk1GdXNycXk4NEtvMTdiSUVVSVZ4Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
  ssl-cert.pem: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCekNDQWUrZ0F3SUJBZ0lRUVB0WWpTRWVhL3dkMzlBRFJ2S2pKekFOQmdrcWhraUc5dzBCQVFzRkFEQVUKTVJJd0VBWURWUVFERXdsdVpYVjJaV04wYjNJd0hoY05Nall3TVRBMk1qQXpPVFUwV2hjTk1qY3dNVEEyTWpBegpPVFUwV2pBVU1SSXdFQVlEVlFRREV3bHVaWFYyWldOMGIzSXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCCkR3QXdnZ0VLQW9JQkFRREw1eFM2aGJFbmxTL1M1ZUdOU3NWWGRKYUcxZTNuZDBXRzg2cWo2Sk9Hb1NOV3dKRXUKSzNoZktwTlkvSVlSY2xmSGRINTdleG5vdE1QdHBXVFZHWXM2bWVza25RZ1FGTEJNNmoyTGEwMThZQVl1RVJUUgoxUkJtL0xQa2FBVFRoN1lkZkRyZHM1WGJsVUNweXRmK3A4MzNNWE16WlMwakhWVnY5WlJnK0xveWZQS1UwT0d0CkltdjUrckdDSmhQOE4rRnVrc1Q3dHNJeWNFZjRYL2xCU2ZiZndaVkNGcExpMDcxb2N6cFdQeFM2VXJNOStCSUsKTm54YjFxT2toQ2IwMkRCTklpQUxaeHc0QmxyUStMeUZuMTROc3lnTFAybHNHd2I1emI2bTl2RHRWNnJHOElybwo5UXVqbzZpUmxKSnIrZVk0dVF2SEE2c2N0Rm14WUdraURieWhBZ01CQUFHalZUQlRNQTRHQTFVZER3RUIvd1FFCkF3SUZvREFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0RBWURWUjBUQVFIL0JBSXcKQURBVUJnTlZIUkVFRFRBTGdnbHVaWFYyWldOMGIzSXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBS1UxY1ZtRQo2M2VJa0YrbXBxVkdSWFdqRjhvKzlwbHJJZ24zS2xCV2VDQ01IRzZiS3dza215VW1GZmh6UHJ3YnUzRldwVytyCktmTGRRWkQxa2VIVHhKMDRlSmZ0NkFQNHoyRGI3UzRDUzJoV1YvemlhY1F0NWJFZU5RY2pnSXpRT2hMb2JZdWcKU1lsS0JpWGFSbStJTjZVaVhvSTJkWnphQVVSUlMvNlhnY1RkN20xdnJicDVyckFQL3d2dDN1dUpzMDJRR2hyNgoyQlFjZEVRenQzREo5N0pkSzF4NXZFOEtqR0ljQ1lxVG9vR285VkJtTkJ0ZCtqWU5LZjlxUDllZlNwSFRrWG5kCmZnU3ZKa0hDYXdMOVFpcTFnaW15YnRpWG5MM2JJLzJXTlhZaGEza0VmYVY5cE9DTXVZY2c0bTY5M0hmV3Q4ZkEKL3ZNYk1uR0phWGF0eWIwPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
---
# Source: core/templates/controller-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: neuvector-internal-certs
type: Opaque
---
# Source: core/templates/manager-secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: neuvector-manager-secret
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
type: Opaque
data:
  ssl-cert.key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBcWlzZForVkl0ZW1pbDVrWWNXTzFsWjJRTVNYRjk0V1ZQY00xQlUrMW1sdzFmeW9VCnd5K2RjdjkwbEtVZ1RKNTdLQnZLZ2w3T2dPZ1RSeXJtTC9MazFWaStyaFQzMmhVeUhTRFRsakg4bGtRVitUakwKMkRUeEh0NERsWUw3TGtlMCtiSFRpK2lnUzl2MXIyanU2RWsyejlybzBndHd1d1VyMHo4cXJGcU0vUHl2ZU1Gdgp5NjJrTkJIdXNNemYxNzFjSVRRejNVS2tKNDRxUzZuVkpFWlRaVkh3bC9HSktmRGtKVjJ4RjBNRk02ajlsU24vCnFJYXYwek9vNmJneW5PK2UzUWhYZ0ZsTG9kbmgvQWdPYThRUHZSU0xjZUFRLzJKdk91bjVLZU9vcmo0NWkrbk8KK0M0ZEFZa1dzWVlNbnlyU2gvcElDa1MxSWs0WVYvaHdBdy9KeHdJREFRQUJBb0lCQURUbWVWcENrNU9Gd1pkNgpMdmlWQkM2eVVGQ1BDeGR6TGgySXNWTm8zNjVRYXdzUXRHcW5RejJzUDN3MFJ6RzZkTlBYcStGU2dzVGRJSjBYCnIzNkpkbTBDalNpRitUVVJNTWFRWFdhTVBKY2tMR2FSS3dHWUY3cytUb1BzdDVSQUUza3FPSGIraHRKK1cwYkEKQ3NFb2ZZTXBiUVpiS3h6Z3N5cVZNUGxxbnZqSVBPR0c4MzNUdWFYd2pVTHQ2d2trRjZMUTI5eTRWUEM4N2ZCawpFM2k0NVpZamduS2ZXYTQzT1FmYUJ6RXgwc0hQYlJVK1Vkb2JvUVdkMEpSeUx2V2VUblA2NDRmbnAzL2tHbFExCldSSWo1QUpvaXFUUVUwdUpnRFlJelVhL3IwTDQyVmN6Q09XWkpBS2hlMGxSTzM5eHF0N1h5RXVjbHV2bUt2VC8KajhQbmJPa0NnWUVBM3VXd3BJZHJNQk1yWXEzQ3dFNzB0cmY4cit6ME5GcG8wNnlGSjBXeWkvTzlaN25MVkFtcwo0emtOSktjVjZCUHZoQVp5YUFaK3NOWFBZWjNocTYzdHJVU2VnVHJ5L0dDVG9OTk94NGZjVlZyYnBDU2pwcThCCm93MmwzZkdHMTZESHZ5UThqdlNJZHJNU3IxUGVEUlNBdVVQVzlJYTVGYmI1d2F3cmc2V2pNSWtDZ1lFQXczQzcKb0RvU21VMFBGNzY0TXBVbkdrVVVPUys5ZGtwY2NwNlhHRG1ieVIxS2FyakxocUwzRzEydHJSTG81MFlDUVMvdQpoVUF4QWZpVE1GRTJjSVVBeGpXOVlrSUVhZ21WWTJicDVycFRzejRvdXpTWWd2Z0tRQ3JENzVsVWJkcUFydjJHCnZHOUJsWXdWUXh4dmcxWmFWSGUzZ0ZSWVd4QmVLUUd0bHB0ZWM4OENnWUVBMnA1Z05jOVljMnVwMXZ4a2txZ2UKWHdSd1E4RGQrR2RnZjVTcmVNeGtoZDRIdksrL1hPcXNkcVRqWGpxL1FzUWkzTlJSNi9QSzJQaXNrYXIveDVvdApEdy9KZ3lqbFlHSDlDZldYUkI3ZUhaMmk1Z2pGdGx2WitDb1BzSE1QZFhpTjBjemgxTGpGQzk4eGlXTngzRlJxCnVNdHdEcUFBOHVwblp1ek9OUzRGdERrQ2dZRUFoQzRtZDROUE9PZHBJY0lYaWY1ZVorSDRmNFRPT3Nhb0o4MGkKbTN1NjVSWXVVbWVSSHdudzNrMUpQUmpnOUNuaE5IMWFjRHl0Nkl0WjRQL01OZVYrVkkvYitpeDBGOU5MZWVNTQpwc08yQURBMkZBYktieW1hcFROSE9URVdiUVd1cXF0RkNRU2w4cUsvYnBnNHd6Y1ArTGpQSHJmczJnb0Q1UEFCCm15NlJmdmtDZ1lBb3BzVFFNeGJNVXdiWGZjR2FKY24wdWNuYzZ4T2FYVTBpcXgxVG40V1QzZGsyZHF0M0JwaDEKVHNxclozaEh2bnRUMmYrMzZ0U1haOUoxemtORWxFd2Irb1k2c3lITXNOWkpXZmxpQks2VlBmK0VOZENmOWs2dwpUeEFHcUUzV3V1M3NWUlZ4VWFXWVdRQWdQZms5R2dmY1JKZ1FmUmdxRzJlSXFzWXZuVWlxekE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
  ssl-cert.pem: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCekNDQWUrZ0F3SUJBZ0lRVDV5TWlZeHE0VEMzT0xhS0ViMm5EVEFOQmdrcWhraUc5dzBCQVFzRkFEQVUKTVJJd0VBWURWUVFERXdsdVpYVjJaV04wYjNJd0hoY05Nall3TVRBMk1qQXpPVFUwV2hjTk1qY3dNVEEyTWpBegpPVFUwV2pBVU1SSXdFQVlEVlFRREV3bHVaWFYyWldOMGIzSXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCCkR3QXdnZ0VLQW9JQkFRQ3FLeDFuNVVpMTZhS1htUmh4WTdXVm5aQXhKY1gzaFpVOXd6VUZUN1dhWERWL0toVEQKTDUxeS8zU1VwU0JNbm5zb0c4cUNYczZBNkJOSEt1WXY4dVRWV0w2dUZQZmFGVElkSU5PV01meVdSQlg1T012WQpOUEVlM2dPVmd2c3VSN1Q1c2RPTDZLQkwyL1d2YU83b1NUYlAydWpTQzNDN0JTdlRQeXFzV296OC9LOTR3Vy9MCnJhUTBFZTZ3ek4vWHZWd2hORFBkUXFRbmppcExxZFVrUmxObFVmQ1g4WWtwOE9RbFhiRVhRd1V6cVAyVktmK28KaHEvVE02anB1REtjNzU3ZENGZUFXVXVoMmVIOENBNXJ4QSs5Rkl0eDRCRC9ZbTg2NmZrcDQ2aXVQam1MNmM3NApMaDBCaVJheGhneWZLdEtIK2tnS1JMVWlUaGhYK0hBREQ4bkhBZ01CQUFHalZUQlRNQTRHQTFVZER3RUIvd1FFCkF3SUZvREFkQmdOVkhTVUVGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0RBWURWUjBUQVFIL0JBSXcKQURBVUJnTlZIUkVFRFRBTGdnbHVaWFYyWldOMGIzSXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBSmZiOHdBSwplaUYvcmRicnBhNUcvWkliQUJaYUhINjZwYmhjN1B6MUhyVHlHR1REZlMvei9va0d1VHR4MlVoa2JsZWo4VkVrCmdoZzNYTmVRVWx2RkFpL3hlbHVsSUVQSXd4RUVwUjBZZGhBaTM1SnpLRGpkNXRVc1piZVdXdy9CYzhYWmgzWnQKNjBiWHhKT0FSWjFHR3ZoQ1hjVDk5YnpPaHVRSDQ1WUxnbzc1N1NIMDlwQld5aGhwOTV6My9POGM5TjhUdFAweQpRUExTVHIzbkhhMnJteWtwTXZHY25sdWk1UTkyTlVZMkh3dnhqUWZhckl1SEFMVlczM0d4VU9kSWJwRDVOSkg0CjlUSUZXTHBsZzliWXJSeTZzdytFYlNqS212Tkp3OWRBdzNKRU9UazAycUIwMjg1YUpuNFdyRURMQWN1ZktoRnAKZzltM21yRTZWOGlCWndJPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
---
# Source: core/templates/crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nvsecurityrules.neuvector.com
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  group: neuvector.com
  names:
    kind: NvSecurityRule
    listKind: NvSecurityRuleList
    plural: nvsecurityrules
    singular: nvsecurityrule
  scope: Namespaced
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              egress:
                items:
                  properties:
                    action:
                      enum:
                      - allow
                      - deny
                      type: string
                    applications:
                      items:
                        type: string
                      type: array
                    name:
                      type: string
                    ports:
                      type: string
                    priority:
                      type: integer
                    selector:
                      properties:
                        comment:
                          type: string
                        criteria:
                          items:
                            properties:
                              key:
                                type: string
                              op:
                                type: string
                              value:
                                type: string
                            required:
                            - key
                            - op
                            - value
                            type: object
                          type: array
                        name:
                          type: string
                        name_referral:
                          type: boolean
                        original_name:
                          type: string
                      required:
                      - name
                      type: object
                  required:
                  - action
                  - name
                  - selector
                  type: object
                type: array
              file:
                items:
                  properties:
                    app:
                      items:
                        type: string
                      type: array
                    behavior:
                      enum:
                      - monitor_change
                      - block_access
                      type: string
                    filter:
                      type: string
                    recursive:
                      type: boolean
                  required:
                  - behavior
                  - filter
                  type: object
                type: array
              ingress:
                items:
                  properties:
                    action:
                      enum:
                      - allow
                      - deny
                      type: string
                    applications:
                      items:
                        type: string
                      type: array
                    name:
                      type: string
                    ports:
                      type: string
                    priority:
                      type: integer
                    selector:
                      properties:
                        comment:
                          type: string
                        criteria:
                          items:
                            properties:
                              key:
                                type: string
                              op:
                                type: string
                              value:
                                type: string
                            required:
                            - key
                            - op
                            - value
                            type: object
                          type: array
                        name:
                          type: string
                        name_referral:
                          type: boolean
                        original_name:
                          type: string
                      required:
                      - name
                      type: object
                  required:
                  - action
                  - name
                  - selector
                  type: object
                type: array
              process:
                items:
                  properties:
                    action:
                      enum:
                      - allow
                      - deny
                      type: string
                    allow_update:
                      type: boolean
                    name:
                      type: string
                    path:
                      type: string
                  required:
                  - action
                  type: object
                type: array
              process_profile:
                properties:
                  baseline:
                    enum:
                    - default
                    - shield
                    - basic
                    - zero-drift
                    type: string
                  mode:
                    enum:
                    - Discover
                    - Monitor
                    - Protect
                    type: string
                type: object
              response:
                items:
                  properties:
                    policy_name:
                      enum:
                      - default
                      type: string
                    event:
                      enum:
                      - event
                      - security-event
                      - cve-report
                      - compliance
                      type: string
                    comment:
                      type: string
                    conditions:
                      items:
                        properties:
                          type:
                            type: string
                          value:
                            type: string
                        required:
                        - type
                        - value
                        type: object
                      type: array
                    actions:
                      items:
                        enum:
                        - quarantine
                        - suppress-log
                        - webhook
                        type: string
                      minItems: 1
                      type: array
                    webhooks:
                      items:
                        type: string
                      type: array
                    disable:
                      type: boolean
                  required:
                  - policy_name
                  - event
                  - actions
                  type: object
                type: array
              target:
                properties:
                  policymode:
                    enum:
                    - Discover
                    - Monitor
                    - Protect
                    - N/A
                    type: string
                  selector:
                    properties:
                      comment:
                        type: string
                      criteria:
                        items:
                          properties:
                            key:
                              type: string
                            op:
                              type: string
                            value:
                              type: string
                          required:
                          - key
                          - op
                          - value
                          type: object
                        type: array
                      name:
                        type: string
                      name_referral:
                        type: boolean
                      original_name:
                        type: string
                      mon_metric:
                        type: boolean
                      grp_sess_cur:
                        type: integer
                      grp_sess_rate:
                        type: integer
                      grp_band_width:
                        type: integer
                    required:
                    - name
                    type: object
                required:
                - selector
                type: object
              dlp:
                properties:
                  settings:
                    items:
                      properties:
                        action:
                          enum:
                          - allow
                          - deny
                          type: string
                        name:
                          type: string
                      required:
                      - name
                      - action
                      type: object
                    type: array
                  status:
                    type: boolean
                type: object
              waf:
                properties:
                  settings:
                    items:
                      properties:
                        action:
                          enum:
                          - allow
                          - deny
                          type: string
                        name:
                          type: string
                      required:
                      - name
                      - action
                      type: object
                    type: array
                  status:
                    type: boolean
                type: object
            required:
            - target
            type: object
        type: object
---
# Source: core/templates/crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nvclustersecurityrules.neuvector.com
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  group: neuvector.com
  names:
    kind: NvClusterSecurityRule
    listKind: NvClusterSecurityRuleList
    plural: nvclustersecurityrules
    singular: nvclustersecurityrule
  scope: Cluster
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              egress:
                items:
                  properties:
                    action:
                      enum:
                      - allow
                      - deny
                      type: string
                    applications:
                      items:
                        type: string
                      type: array
                    name:
                      type: string
                    ports:
                      type: string
                    priority:
                      type: integer
                    selector:
                      properties:
                        comment:
                          type: string
                        criteria:
                          items:
                            properties:
                              key:
                                type: string
                              op:
                                type: string
                              value:
                                type: string
                            required:
                            - key
                            - op
                            - value
                            type: object
                          type: array
                        name:
                          type: string
                        name_referral:
                          type: boolean
                        original_name:
                          type: string
                      required:
                      - name
                      type: object
                  required:
                  - action
                  - name
                  - selector
                  type: object
                type: array
              file:
                items:
                  properties:
                    app:
                      items:
                        type: string
                      type: array
                    behavior:
                      enum:
                      - monitor_change
                      - block_access
                      type: string
                    filter:
                      type: string
                    recursive:
                      type: boolean
                  required:
                  - behavior
                  - filter
                  type: object
                type: array
              ingress:
                items:
                  properties:
                    action:
                      enum:
                      - allow
                      - deny
                      type: string
                    applications:
                      items:
                        type: string
                      type: array
                    name:
                      type: string
                    ports:
                      type: string
                    priority:
                      type: integer
                    selector:
                      properties:
                        comment:
                          type: string
                        criteria:
                          items:
                            properties:
                              key:
                                type: string
                              op:
                                type: string
                              value:
                                type: string
                            required:
                            - key
                            - op
                            - value
                            type: object
                          type: array
                        name:
                          type: string
                        name_referral:
                          type: boolean
                        original_name:
                          type: string
                      required:
                      - name
                      type: object
                  required:
                  - action
                  - name
                  - selector
                  type: object
                type: array
              process:
                items:
                  properties:
                    action:
                      enum:
                      - allow
                      - deny
                      type: string
                    allow_update:
                      type: boolean
                    name:
                      type: string
                    path:
                      type: string
                  required:
                  - action
                  type: object
                type: array
              process_profile:
                properties:
                  baseline:
                    enum:
                    - default
                    - shield
                    - basic
                    - zero-drift
                    type: string
                  mode:
                    enum:
                    - Discover
                    - Monitor
                    - Protect
                    type: string
                type: object
              response:
                items:
                  properties:
                    policy_name:
                      enum:
                      - default
                      type: string
                    event:
                      enum:
                      - event
                      - security-event
                      - cve-report
                      - compliance
                      type: string
                    comment:
                      type: string
                    conditions:
                      items:
                        properties:
                          type:
                            type: string
                          value:
                            type: string
                        required:
                        - type
                        - value
                        type: object
                      type: array
                    actions:
                      items:
                        enum:
                        - quarantine
                        - suppress-log
                        - webhook
                        type: string
                      minItems: 1
                      type: array
                    webhooks:
                      items:
                        type: string
                      type: array
                    disable:
                      type: boolean
                  required:
                  - policy_name
                  - event
                  - actions
                  type: object
                type: array
              target:
                properties:
                  policymode:
                    enum:
                    - Discover
                    - Monitor
                    - Protect
                    - N/A
                    type: string
                  selector:
                    properties:
                      comment:
                        type: string
                      criteria:
                        items:
                          properties:
                            key:
                              type: string
                            op:
                              type: string
                            value:
                              type: string
                          required:
                          - key
                          - op
                          - value
                          type: object
                        type: array
                      name:
                        type: string
                      name_referral:
                        type: boolean
                      original_name:
                        type: string
                      mon_metric:
                        type: boolean
                      grp_sess_cur:
                        type: integer
                      grp_sess_rate:
                        type: integer
                      grp_band_width:
                        type: integer
                    required:
                    - name
                    type: object
                required:
                - selector
                type: object
              dlp:
                properties:
                  settings:
                    items:
                      properties:
                        action:
                          enum:
                          - allow
                          - deny
                          type: string
                        name:
                          type: string
                      required:
                      - name
                      - action
                      type: object
                    type: array
                  status:
                    type: boolean
                type: object
              waf:
                properties:
                  settings:
                    items:
                      properties:
                        action:
                          enum:
                          - allow
                          - deny
                          type: string
                        name:
                          type: string
                      required:
                      - name
                      - action
                      type: object
                    type: array
                  status:
                    type: boolean
                type: object
            required:
            - target
            type: object
        type: object
---
# Source: core/templates/crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nvdlpsecurityrules.neuvector.com
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  group: neuvector.com
  names:
    kind: NvDlpSecurityRule
    listKind: NvDlpSecurityRuleList
    plural: nvdlpsecurityrules
    singular: nvdlpsecurityrule
  scope: Cluster
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              sensor:
                properties:
                  comment:
                    type: string
                  name:
                    type: string
                  rules:
                    items:
                      properties:
                        name:
                          type: string
                        patterns:
                          items:
                            properties:
                              context:
                                enum:
                                - url
                                - header
                                - body
                                - packet
                                type: string
                              key:
                                enum:
                                - pattern
                                type: string
                              op:
                                enum:
                                - regex
                                - '!regex'
                                type: string
                              value:
                                type: string
                            required:
                            - key
                            - op
                            - value
                            - context
                            type: object
                          type: array
                      required:
                      - name
                      - patterns
                      type: object
                    type: array
                required:
                - name
                type: object
            required:
            - sensor
            type: object
        type: object
---
# Source: core/templates/crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nvadmissioncontrolsecurityrules.neuvector.com
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  group: neuvector.com
  names:
    kind: NvAdmissionControlSecurityRule
    listKind: NvAdmissionControlSecurityRuleList
    plural: nvadmissioncontrolsecurityrules
    singular: nvadmissioncontrolsecurityrule
  scope: Cluster
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              config:
                properties:
                  client_mode:
                    enum:
                    - service
                    - url
                    type: string
                  enable:
                    type: boolean
                  mode:
                    enum:
                    - monitor
                    - protect
                    type: string
                required:
                - enable
                - mode
                - client_mode
                type: object
              rules:
                items:
                  properties:
                    action:
                      enum:
                      - allow
                      - deny
                      type: string
                    comment:
                      type: string
                    conversion_id_ref:
                      type: integer
                    criteria:
                      items:
                        properties:
                          name:
                            type: string
                          op:
                            type: string
                          path:
                            type: string
                          sub_criteria:
                            items:
                              properties:
                                name:
                                  type: string
                                op:
                                  type: string
                                value:
                                  type: string
                              required:
                              - name
                              - op
                              - value
                              type: object
                            type: array
                          template_kind:
                            type: string
                          type:
                            type: string
                          value:
                            type: string
                          value_type:
                            type: string
                        required:
                        - name
                        - op
                        - value
                        type: object
                      type: array
                    disabled:
                      type: boolean
                    id:
                      type: integer
                    rule_mode:
                      enum:
                      - ""
                      - monitor
                      - protect
                      type: string
                    containers:
                      items:
                        enum:
                        - containers
                        - init_containers
                        - ephemeral_containers
                        type: string
                      type: array
                  required:
                  - action
                  - criteria
                  type: object
                type: array
            type: object
        type: object
---
# Source: core/templates/crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nvwafsecurityrules.neuvector.com
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  group: neuvector.com
  names:
    kind: NvWafSecurityRule
    listKind: NvWafSecurityRuleList
    plural: nvwafsecurityrules
    singular: nvwafsecurityrule
  scope: Cluster
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              sensor:
                properties:
                  comment:
                    type: string
                  name:
                    type: string
                  rules:
                    items:
                      properties:
                        name:
                          type: string
                        patterns:
                          items:
                            properties:
                              context:
                                enum:
                                - url
                                - header
                                - body
                                - packet
                                type: string
                              key:
                                enum:
                                - pattern
                                type: string
                              op:
                                enum:
                                - regex
                                - '!regex'
                                type: string
                              value:
                                type: string
                            required:
                            - key
                            - op
                            - value
                            - context
                            type: object
                          type: array
                      required:
                      - name
                      - patterns
                      type: object
                    type: array
                required:
                - name
                type: object
            required:
            - sensor
            type: object
        type: object
---
# Source: core/templates/crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nvcomplianceprofiles.neuvector.com
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  group: neuvector.com
  names:
    kind: NvComplianceProfile
    listKind: NvComplianceProfileList
    plural: nvcomplianceprofiles
    singular: nvcomplianceprofile
  scope: Cluster
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              templates:
                properties:
                  disable_system:
                    type: boolean
                  entries:
                    items:
                      properties:
                        tags:
                          items:
                            type: string
                          type: array
                        test_number:
                          type: string
                      required:
                      - test_number
                      type: object
                    type: array
                required:
                - entries
                type: object
            type: object
        type: object
---
# Source: core/templates/crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nvvulnerabilityprofiles.neuvector.com
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  group: neuvector.com
  names:
    kind: NvVulnerabilityProfile
    listKind: NvVulnerabilityProfileList
    plural: nvvulnerabilityprofiles
    singular: nvvulnerabilityprofile
  scope: Cluster
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              profile:
                properties:
                  entries:
                    items:
                      properties:
                        comment:
                          type: string
                        days:
                          type: integer
                        domains:
                          items:
                            type: string
                          type: array
                        images:
                          items:
                            type: string
                          type: array
                        name:
                          type: string
                      required:
                      - name
                      type: object
                    type: array
                required:
                - entries
                type: object
            required:
            - profile
            type: object
        type: object
---
# Source: core/templates/crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nvgroupdefinitions.neuvector.com
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  group: neuvector.com
  names:
    kind: NvGroupDefinition
    listKind: NvGroupDefinitionList
    plural: nvgroupdefinitions
    singular: nvgroupdefinition
  scope: Namespaced
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              selector:
                properties:
                  comment:
                    type: string
                  criteria:
                    items:
                      properties:
                        key:
                          type: string
                        op:
                          type: string
                        value:
                          type: string
                      required:
                      - key
                      - op
                      - value
                      type: object
                    type: array
                  name:
                    type: string
                required:
                - name
                type: object
            required:
            - selector
            type: object
        type: object
---
# Source: core/templates/crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: nvresponserulesecurityrules.neuvector.com
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  group: neuvector.com
  names:
    kind: NvResponseRuleSecurityRule
    listKind: NvResponseRuleSecurityRuleList
    plural: nvresponserulesecurityrules
    singular: nvresponserulesecurityrule
  scope: Cluster
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        properties:
          spec:
            properties:
              rule:
                properties:
                  policy_name:
                    enum:
                    - default
                    type: string
                  event:
                    enum:
                    - event
                    - security-event
                    - cve-report
                    - compliance
                    - admission-control
                    type: string
                  comment:
                    type: string
                  conditions:
                    items:
                      properties:
                        type:
                          type: string
                        value:
                          type: string
                      required:
                      - type
                      - value
                      type: object
                    type: array
                  actions:
                    items:
                      enum:
                      - quarantine
                      - suppress-log
                      - webhook
                      type: string
                    minItems: 1
                    type: array
                  webhooks:
                    items:
                      type: string
                    type: array
                  disable:
                    type: boolean
                required:
                - policy_name
                - event
                - actions
                type: object
            required:
            - rule
            type: object
        type: object
---
# Source: core/templates/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-app
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - ""
  resources:
  - nodes
  - pods
  - services
  - namespaces
  verbs:
  - get
  - list
  - watch
  - update
---
# Source: core/templates/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-rbac
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - rolebindings
  - roles
  - clusterrolebindings
  - clusterroles
  verbs:
  - get
  - list
  - watch
---
# Source: core/templates/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-admission
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - admissionregistration.k8s.io
  resources:
  - validatingwebhookconfigurations
  - mutatingwebhookconfigurations
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - delete
---
# Source: core/templates/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-nvgroupdefinitions
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - neuvector.com
  resources:
  - nvgroupdefinitions
  verbs:
  - get
  - list
  - delete
---
# Source: core/templates/crd-role.yaml
# ClusterRole for NeuVector to operate CRD
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-customresourcedefinition
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - apiextensions.k8s.io
  resources:
  - customresourcedefinitions
  verbs:
  - update
  - watch
  - create
  - get
---
# Source: core/templates/crd-role.yaml
# ClusterRole for NeuVector to manage network/process CRD rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-nvsecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - neuvector.com
  resources:
  - nvsecurityrules
  - nvclustersecurityrules
  verbs:
  - get
  - list
  - delete
---
# Source: core/templates/crd-role.yaml
# ClusterRole for NeuVector to manage dlp CRD rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-nvdlpsecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - neuvector.com
  resources:
  - nvdlpsecurityrules
  verbs:
  - get
  - list
  - delete
---
# Source: core/templates/crd-role.yaml
# ClusterRole for NeuVector to manage admission control CRD rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-nvadmissioncontrolsecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - neuvector.com
  resources:
  - nvadmissioncontrolsecurityrules
  verbs:
  - get
  - list
  - delete
---
# Source: core/templates/crd-role.yaml
# ClusterRole for NeuVector to manage waf CRD rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-nvwafsecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - neuvector.com
  resources:
  - nvwafsecurityrules
  verbs:
  - get
  - list
  - delete
---
# Source: core/templates/crd-role.yaml
# ClusterRole for NeuVector to manage compliance CRD profiles
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-nvcomplianceprofiles
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - neuvector.com
  resources:
  - nvcomplianceprofiles
  verbs:
  - get
  - list
  - delete
---
# Source: core/templates/crd-role.yaml
# ClusterRole for NeuVector to manage vulnerability CRD profiles
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-nvvulnerabilityprofiles
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - neuvector.com
  resources:
  - nvvulnerabilityprofiles
  verbs:
  - get
  - list
  - delete
---
# Source: core/templates/crd-role.yaml
# ClusterRole for NeuVector to manage response rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: neuvector-binding-nvresponserulesecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - neuvector.com
  resources:
  - nvresponserulesecurityrules
  verbs:
  - get
  - list
  - delete
---
# Source: core/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-app
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-app
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-rbac
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-rbac
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-admission
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-admission
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-view
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: view
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/crd-role.yaml
# ClusterRoleBinding for NeuVector to operate CRD
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-customresourcedefinition
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-customresourcedefinition
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/crd-role.yaml
# ClusterRoleBinding for NeuVector to manage network/process CRD rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-nvsecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-nvsecurityrules
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/crd-role.yaml
# ClusterRoleBinding for NeuVector to manage admission control CRD rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-nvdlpsecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-nvdlpsecurityrules
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/crd-role.yaml
# ClusterRoleBinding for NeuVector to manage admission control CRD rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-nvadmissioncontrolsecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-nvadmissioncontrolsecurityrules
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/crd-role.yaml
# ClusterRoleBinding for NeuVector to manage waf CRD rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-nvwafsecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-nvwafsecurityrules
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/crd-role.yaml
# ClusterRoleBinding for NeuVector to manage compliance CRD profiles
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-nvcomplianceprofiles
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-nvcomplianceprofiles
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/crd-role.yaml
# ClusterRoleBinding for NeuVector to manage vulnerability CRD profiles
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-nvvulnerabilityprofiles
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-nvvulnerabilityprofiles
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/crd-role.yaml
# ClusterRoleBinding for NeuVector to manage response rules
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-nvresponserulesecurityrules
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-nvresponserulesecurityrules
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/crd-role.yaml
# Clusterrolebinding for Neuvector to manage name referral for common groups
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: neuvector-binding-nvgroupdefinitions
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: neuvector-binding-nvgroupdefinitions
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: neuvector-binding-secret
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - get
  - list
  - watch
---
# Source: core/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: neuvector-binding-lease
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - create
  - get
  - update
---
# Source: core/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: neuvector-binding-job-creation
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - batch
  resources:
  - jobs
  verbs:
  - create
  - get
  - delete
- apiGroups:
  - batch
  resources:
  - cronjobs
  - cronjobs/finalizers
  verbs:
  - update
  - patch
---
# Source: core/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: neuvector-binding-cert-upgrader
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - get
  - update
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - get
  - list
- apiGroups:
  - "apps"
  resources:
  - deployments
  - daemonsets
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - batch
  resources:
  - cronjobs
  verbs:
  - update
---
# Source: core/templates/role.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: neuvector-binding-secret-controller
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
rules:
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - create
  - update
  - patch
---
# Source: core/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: neuvector-admin
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: admin
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: neuvector-binding-secret
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: neuvector-binding-secret
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/rolebinding.yaml
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: neuvector-binding-lease
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: neuvector-binding-lease
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: neuvector-binding-job-creation
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: neuvector-binding-job-creation
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: neuvector-binding-secret-controller
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: neuvector-binding-secret-controller
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/rolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: neuvector-binding-cert-upgrader
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: neuvector-binding-cert-upgrader
subjects:
- kind: ServiceAccount
  name: default
  namespace: neuvector
---
# Source: core/templates/admission-webhook-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: neuvector-svc-admission-webhook
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  ports:
    - port: 443
      targetPort: 20443
      protocol: TCP
      name: admission-webhook
  type: ClusterIP
  selector:
    app: neuvector-controller-pod
---
# Source: core/templates/controller-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: neuvector-svc-controller
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  clusterIP: None
  ports:
    - port: 18300
      protocol: "TCP"
      name: "cluster-tcp-18300"
    - port: 18301
      protocol: "TCP"
      name: "cluster-tcp-18301"
    - port: 18301
      protocol: "UDP"
      name: "cluster-udp-18301"
  selector:
    app: neuvector-controller-pod
---
# Source: core/templates/crd-webhook-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: neuvector-svc-crd-webhook
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  ports:
    - port: 443
      targetPort: 30443
      protocol: TCP
      name: crd-webhook
  type: ClusterIP
  selector:
    app: neuvector-controller-pod
---
# Source: core/templates/manager-service.yaml
apiVersion: v1
kind: Service
metadata:
  name: neuvector-service-webui
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  type: ClusterIP
  ports:
    - port: 8443
      name: manager
      protocol: TCP
  selector:
    app: neuvector-manager-pod
---
# Source: core/templates/enforcer-daemonset.yaml
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: neuvector-enforcer-pod
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  updateStrategy:
    type: RollingUpdate
  selector:
    matchLabels:
      app: neuvector-enforcer-pod
  template:
    metadata:
      labels:
        app: neuvector-enforcer-pod
        release: neuvector
    spec:
      tolerations:
        - effect: NoSchedule
          key: node-role.kubernetes.io/master
        - effect: NoSchedule
          key: node-role.kubernetes.io/control-plane
        - effect: NoSchedule
          key: node-role.kubernetes.io/etcd
      hostPID: true
      serviceAccountName: default
      serviceAccount: default
      containers:
        - name: neuvector-enforcer-pod
          image: "docker.io/neuvector/enforcer:5.4.8"
          imagePullPolicy: IfNotPresent
          securityContext:
            privileged: true
          resources:
            {}
          env:
            - name: CLUSTER_JOIN_ADDR
              value: neuvector-svc-controller.neuvector
            - name: CLUSTER_ADVERTISED_ADDR
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: CLUSTER_BIND_ADDR
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: AUTO_INTERNAL_CERT
              value: "1"
          volumeMounts:
            - mountPath: /lib/modules
              name: modules-vol
              readOnly: true
            - mountPath: /var/nv_debug
              name: nv-debug
              readOnly: false
            - mountPath: /etc/neuvector/certs/internal/
              name: internal-cert-dir
      terminationGracePeriodSeconds: 1200
      restartPolicy: Always
      volumes:
        - name: modules-vol
          hostPath:
            path: /lib/modules
        - name: nv-debug
          hostPath:
            path: /var/nv_debug
        - name: internal-cert-dir
          emptyDir:
            sizeLimit: 50Mi
---
# Source: core/templates/controller-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: neuvector-controller-pod
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  replicas: 3
  minReadySeconds: 60
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  selector:
    matchLabels:
      app: neuvector-controller-pod
  template:
    metadata:
      labels:
        app: neuvector-controller-pod
        release: neuvector
      annotations:
        checksum/controller-secret: 877c44a71a2fba9a8ea586c33f3fe9e42df121292cbbb656e8d4da5079eefad1
    spec:
      affinity:
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchExpressions:
                - key: app
                  operator: In
                  values:
                  - neuvector-controller-pod
              topologyKey: kubernetes.io/hostname
            weight: 100
      serviceAccountName: default
      serviceAccount: default
      initContainers:
        - name: init
          image: "docker.io/neuvector/controller:5.4.8"
          command: ["/usr/local/bin/upgrader", "create-upgrader-job" ]
          imagePullPolicy: IfNotPresent
          resources:
                {}
          env:
            - name: OVERRIDE_CHECKSUM
              value: a2e958550b175529dd0913263e15f45c8072ec73c52ee635355311355a2b7e45
      containers:
        - name: neuvector-controller-pod
          image: "docker.io/neuvector/controller:5.4.8"
          imagePullPolicy: IfNotPresent
          securityContext:
            runAsUser: 0
          resources:
            {}
          readinessProbe:
            exec:
              command:
                - cat
                - /tmp/ready
            initialDelaySeconds: 5
            periodSeconds: 5
          env:
            - name: CTRL_SERVER_PORT
              value: "10443"
            - name: CLUSTER_JOIN_ADDR
              value: neuvector-svc-controller.neuvector
            - name: CLUSTER_ADVERTISED_ADDR
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: CLUSTER_BIND_ADDR
              valueFrom:
                fieldRef:
                  fieldPath: status.podIP
            - name: AUTO_INTERNAL_CERT
              value: "1"
          volumeMounts:
            - mountPath: /etc/config
              name: config-volume
              readOnly: true
            - mountPath: /etc/neuvector/certs/ssl-cert.key
              subPath: ssl-cert.key
              name: cert
              readOnly: true
            - mountPath: /etc/neuvector/certs/ssl-cert.pem
              subPath: ssl-cert.pem
              name: cert
              readOnly: true
            - mountPath: /etc/neuvector/certs/internal/
              name: internal-cert-dir
      terminationGracePeriodSeconds: 300
      restartPolicy: Always
      volumes:
        - name: config-volume
          projected:
            sources:
              - configMap:
                  name: neuvector-init
                  optional: true
              - secret:
                  name: neuvector-init
                  optional: true
              - secret:
                  name: neuvector-secret
                  optional: true
        - name: cert
          secret:
            secretName: neuvector-controller-secret
        - name: internal-cert-dir
          emptyDir:
            sizeLimit: 50Mi
---
# Source: core/templates/manager-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: neuvector-manager-pod
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  replicas: 1
  selector:
    matchLabels:
      app: neuvector-manager-pod
  template:
    metadata:
      labels:
        app: neuvector-manager-pod
        release: neuvector
      annotations:
        checksum/manager-secret: 921b555ecc4a8fb5e0df4c98ae74cec3889437e55c178ba4076167c5ebfede85
    spec:
      serviceAccountName: default
      serviceAccount: default
      containers:
        - name: neuvector-manager-pod
          image: "docker.io/neuvector/manager:5.4.8"
          imagePullPolicy: IfNotPresent
          ports:
            - name: http
              containerPort: 8443
              protocol: TCP
          env:
            - name: CTRL_SERVER_PORT
              value: "10443"
            - name: MANAGER_SERVER_PORT
              value: "8443"
            - name: CTRL_SERVER_IP
              value: neuvector-svc-controller.neuvector
          volumeMounts:
            - mountPath: /etc/neuvector/certs/ssl-cert.key
              subPath: ssl-cert.key
              name: cert
              readOnly: true
            - mountPath: /etc/neuvector/certs/ssl-cert.pem
              subPath: ssl-cert.pem
              name: cert
              readOnly: true
          resources:
            {}
      restartPolicy: Always
      volumes:
        - name: cert
          secret:
            secretName: neuvector-manager-secret
---
# Source: core/templates/scanner-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: neuvector-scanner-pod
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  replicas: 3
  selector:
    matchLabels:
      app: neuvector-scanner-pod
  template:
    metadata:
      labels:
        app: neuvector-scanner-pod
    spec:
      serviceAccountName: default
      serviceAccount: default
      containers:
        - name: neuvector-scanner-pod
          image: "docker.io/neuvector/scanner:6"
          imagePullPolicy: Always
          env:
            - name: CLUSTER_JOIN_ADDR
              value: neuvector-svc-controller.neuvector
            - name: AUTO_INTERNAL_CERT
              value: "1"
          resources:
            {}
          volumeMounts:
            - mountPath: /etc/neuvector/certs/internal/
              name: internal-cert-dir
      restartPolicy: Always
      volumes:
        - name: internal-cert-dir
          emptyDir:
            sizeLimit: 50Mi
---
# Source: core/templates/updater-cronjob.yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: neuvector-updater-pod
  namespace: neuvector
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  schedule: "0 0 * * *"
  jobTemplate:
    spec:
      template:
        metadata:
          labels:
            app: neuvector-updater-pod
            release: neuvector
        spec:
          serviceAccountName: default
          serviceAccount: default
          containers:
            - name: neuvector-updater-pod
              image: "docker.io/neuvector/updater:0.0.7"
              imagePullPolicy: IfNotPresent
              resources:
                {}
              command:
              - /bin/sh
              - -c
              - /usr/bin/curl -kv -X PATCH -H "Authorization:Bearer $(cat /var/run/secrets/kubernetes.io/serviceaccount/token)" -H "Content-Type:application/strategic-merge-patch+json" -d '{"spec":{"template":{"metadata":{"annotations":{"kubectl.kubernetes.io/restartedAt":"'`date +%Y-%m-%dT%H:%M:%S%z`'"}}}}}' 'https://kubernetes.default/apis/apps/v1/namespaces/neuvector/deployments/neuvector-scanner-pod' 2>&1 | grep -v Bearer
          restartPolicy: Never
---
# Source: core/templates/upgrader-cronjob.yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: neuvector-cert-upgrader-pod
  namespace: neuvector
  annotations:
    cert-upgrader-uid: ""
  labels:
    chart: core-2.8.10
    release: neuvector
spec:
  schedule: "0 0 1 1 *"
  suspend: true
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 3
  successfulJobsHistoryLimit: 3
  jobTemplate:
    spec:
      activeDeadlineSeconds: 3600
      parallelism: 1
      completions: 1
      backoffLimit: 6
      template:
        metadata:
          labels:
            app: neuvector-cert-upgrader-pod
            release: neuvector
        spec:
          serviceAccountName: default
          serviceAccount: default
          restartPolicy: Never
          containers:
            - name: neuvector-cert-upgrader-pod
              image: "docker.io/neuvector/controller:5.4.8"
              imagePullPolicy: IfNotPresent
              resources:
                {}                
              command: 
                - /usr/local/bin/upgrader
                - upgrader-job
                - --enable-rotation
              env:
---
# Source: core/templates/controller-lease.yaml
apiVersion: coordination.k8s.io/v1
kind: Lease
metadata:
  name: neuvector-controller
spec:
  leaseTransitions: 0
---
# Source: core/templates/upgrader-lease.yaml
apiVersion: coordination.k8s.io/v1
kind: Lease
metadata:
  name: neuvector-cert-upgrader
spec:
  leaseTransitions: 0
