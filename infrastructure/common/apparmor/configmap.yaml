apiVersion: v1
kind: ConfigMap
metadata:
  name: apparmor-profiles
  namespace: apparmor
data:
  k8s-apparmor-audit-writes: |-
    #include <tunables/global>
    profile k8s-apparmor-audit-writes flags=(attach_disconnected) {
      #include <abstractions/base>

      network inet tcp,    # network tcp inet protocols 

      deny network raw,
      deny network packet,

      audit file,
      audit umount,        # allow any mount

      # Audit all file writes.
      audit /** w,
    }
